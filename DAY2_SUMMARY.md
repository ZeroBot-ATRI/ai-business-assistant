# Day 2 å®Œæˆæ€»ç»“

## æˆæœæ¦‚è§ˆ

Day 2 çš„æ‰€æœ‰æ ¸å¿ƒä»»åŠ¡å·²å®Œæˆï¼åœ¨Day 1çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¤§å¹…å¢å¼ºäº†ç³»ç»Ÿçš„æ•°æ®ç®¡ç†ã€æŠ€èƒ½åº“å’Œå¯æµ‹è¯•æ€§ã€‚

---

## æ–°å¢æ–‡ä»¶ (5ä¸ª)

1. **app/models.py** (150è¡Œ) - å®Œæ•´çš„Pydanticæ•°æ®æ¨¡å‹
2. **app/database.py** (220è¡Œ) - æ•°æ®åº“å°è£…ç±»
3. **app/skills.py** (200è¡Œ) - MockæŠ€èƒ½åº“
4. **tests/test_day2.py** (195è¡Œ) - å•å…ƒæµ‹è¯•
5. **DAY2_COMPLETED.md** - å®ŒæˆæŠ¥å‘Š

---

## æ ¸å¿ƒæ”¹è¿›

### 1. æ•°æ®æ¨¡å‹åŒ– (app/models.py)
- ä½¿ç”¨Pydanticå®šä¹‰æ‰€æœ‰æ•°æ®ç»“æ„
- APIè¯·æ±‚/å“åº”è‡ªåŠ¨éªŒè¯
- ç±»å‹å®‰å…¨ï¼ŒIDEå‹å¥½

### 2. æ•°æ®åº“å¢å¼º (app/database.py)
```python
# æ–°çš„Databaseç±»æä¾›ï¼š
db.save_decision()           # ä¿å­˜å†³ç­–ï¼ˆæ”¯æŒæ›´å¤šå­—æ®µï¼‰
db.get_recent_decisions()    # è·å–æœ€è¿‘å†³ç­–
db.get_today_stats()         # ä»Šæ—¥ç»Ÿè®¡
db.get_intent_distribution() # æ„å›¾åˆ†å¸ƒ
db.cleanup_old_data()        # æ•°æ®æ¸…ç†
```

### 3. æŠ€èƒ½åº“æ‰©å±• (app/skills.py)
```python
# ä»3ä¸ªæŠ€èƒ½æ‰©å±•åˆ°7ä¸ªï¼š
1. get_order          # æŸ¥è¯¢è®¢å•
2. query_inventory    # æŸ¥è¯¢åº“å­˜
3. send_email         # å‘é€é‚®ä»¶
4. update_order_status    # æ›´æ–°è®¢å•çŠ¶æ€ [æ–°å¢]
5. query_logistics        # æŸ¥è¯¢ç‰©æµ [æ–°å¢]
6. generate_apology       # ç”Ÿæˆé“æ­‰ä¿¡ [æ–°å¢]
7. offer_compensation     # æä¾›è¡¥å¿ [æ–°å¢]
```

### 4. æ—¥å¿—ç³»ç»Ÿ
```python
# å®Œæ•´çš„æ—¥å¿—è®°å½•
logger.info("æ”¶åˆ°ç”¨æˆ·è¯·æ±‚")
logger.error("å¤„ç†å¤±è´¥")
# è‡ªåŠ¨è®°å½•åˆ°æ§åˆ¶å°
```

### 5. æ€§èƒ½ç›‘æ§
```python
# è‡ªåŠ¨è®°å½•ï¼š
- execution_time_ms: æ‰§è¡Œæ—¶é—´
- llm_cost: LLMè°ƒç”¨æˆæœ¬
- success: æˆåŠŸ/å¤±è´¥æ ‡å¿—
```

---

## æ•°æ®åº“ç»“æ„å‡çº§

### ai_decisions è¡¨
```sql
CREATE TABLE ai_decisions (
    id INTEGER PRIMARY KEY,
    user_id TEXT DEFAULT 'default',     -- [æ–°å¢]
    user_input TEXT NOT NULL,
    intent TEXT,
    action TEXT,
    result TEXT,
    success INTEGER DEFAULT 1,          -- [æ–°å¢]
    execution_time_ms REAL,             -- [æ–°å¢]
    llm_cost REAL,                      -- [æ–°å¢]
    timestamp TEXT NOT NULL
);
```

### æ–°å¢ç´¢å¼•
- `idx_decisions_timestamp` - æŒ‰æ—¶é—´æŸ¥è¯¢ä¼˜åŒ–
- `idx_decisions_user` - æŒ‰ç”¨æˆ·æŸ¥è¯¢ä¼˜åŒ–
- `idx_metrics_name` - æŒ‡æ ‡æŸ¥è¯¢ä¼˜åŒ–

---

## APIå˜åŒ–

### POST /chat
**è¯·æ±‚å‚æ•°æ–°å¢**ï¼š
```python
user_id: str = "default"  # ç”¨æˆ·IDï¼ˆå¯é€‰ï¼‰
```

**å“åº”æ–°å¢å­—æ®µ**ï¼š
```json
{
  "debug": {
    "execution_time_ms": 1234.56,
    "llm_cost": 0.001
  }
}
```

### GET /metrics
**è¿”å›çœŸå®æ•°æ®**ï¼ˆä¸å†æ˜¯Mockï¼‰ï¼š
```json
{
  "today_total": 10,
  "success_rate": 0.95,
  "avg_response_ms": 1200,
  "today_cost": 0.01,
  "alerts": [],
  "intent_distribution": [...]
}
```

---

## Mockæ•°æ®åœºæ™¯

### è®¢å•åœºæ™¯
- **è®¢å•12345**: å·²å‘è´§ï¼Œæ­£å¸¸
- **è®¢å•999**: é…é€å»¶è¿Ÿï¼Œå¤©æ°”åŸå› 
- **è®¢å•888**: å¾…å‘è´§

### åº“å­˜åœºæ™¯
- **äº§å“A**: åº“å­˜100ï¼Œæ­£å¸¸
- **äº§å“B**: åº“å­˜15ï¼Œåº“å­˜ä¸è¶³
- **äº§å“C**: åº“å­˜0ï¼Œç¼ºè´§
- **äº§å“D**: åº“å­˜500ï¼Œæ­£å¸¸

---

## æµ‹è¯•æŒ‡å—

### å¿«é€Ÿæµ‹è¯•
```bash
# 1. åˆ é™¤æ—§æ•°æ®åº“ï¼ˆç»“æ„å·²å˜åŒ–ï¼‰
rm database.db

# 2. å¯åŠ¨åç«¯
uvicorn app.main:app --reload

# 3. å¯åŠ¨å‰ç«¯
streamlit run ui/app.py

# 4. æµ‹è¯•åœºæ™¯
- "æŸ¥è¯¢è®¢å•12345çš„çŠ¶æ€"    # æ­£å¸¸è®¢å•
- "æŸ¥è¯¢è®¢å•999çš„çŠ¶æ€"      # å»¶è¿Ÿè®¢å•
- "äº§å“Cè¿˜æœ‰å¤šå°‘åº“å­˜ï¼Ÿ"    # ç¼ºè´§äº§å“
```

### æŸ¥çœ‹æ•°æ®åº“
```bash
sqlite3 database.db "SELECT user_input, intent, success, execution_time_ms FROM ai_decisions"
```

---

## æ€§èƒ½æ•°æ®

| æŒ‡æ ‡ | æ•°å€¼ |
|-----|------|
| æŠ€èƒ½æ•°é‡ | 7ä¸ª |
| ä»£ç è¡Œæ•° | +965è¡Œ |
| æµ‹è¯•ç”¨ä¾‹ | 6ä¸ª |
| APIå“åº” | 1-2ç§’ |
| æ•°æ®åº“æŸ¥è¯¢ | <10ms |

---

## æ–‡ä»¶ç»Ÿè®¡

| æ–‡ä»¶ | è¡Œæ•° | è¯´æ˜ |
|------|------|------|
| app/models.py | 150 | æ•°æ®æ¨¡å‹ |
| app/database.py | 220 | æ•°æ®åº“ç®¡ç† |
| app/skills.py | 200 | æŠ€èƒ½åº“ |
| app/main.py | 300+ | ä¸»APIï¼ˆå¢å¼ºï¼‰ |
| tests/test_day2.py | 195 | å•å…ƒæµ‹è¯• |

**æ€»è®¡æ–°å¢ï¼šçº¦ 965 è¡Œä»£ç **

---

## ä¸‹ä¸€æ­¥å»ºè®®

### é€‰é¡¹1ï¼šç»§ç»­Day 3 (UIä¼˜åŒ–)
- ä¼˜åŒ–Streamlitç•Œé¢
- æ·»åŠ å›¾è¡¨å±•ç¤º
- æ”¹è¿›ç”¨æˆ·ä½“éªŒ

### é€‰é¡¹2ï¼šè·³åˆ°Day 4-5 (çœŸå®API)
- å¯¹æ¥çœŸå®è®¢å•ç³»ç»Ÿ
- å¯¹æ¥çœŸå®åº“å­˜ç³»ç»Ÿ
- é›†æˆçœŸå®é‚®ä»¶æœåŠ¡

### é€‰é¡¹3ï¼šè·³åˆ°Day 6-8 (Orchestrator)
- å®ç°å¤šæ­¥éª¤ç¼–æ’
- æ”¯æŒå¤æ‚ä¸šåŠ¡æµç¨‹
- AIå†³ç­–ä¼˜åŒ–

---

## æäº¤å‘½ä»¤

```bash
# æ£€æŸ¥çŠ¶æ€
git status

# æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# æäº¤
git commit -m "å®ŒæˆDay 2: æ•°æ®æ¨¡å‹ã€æ•°æ®åº“å’ŒæŠ€èƒ½åº“å¢å¼º

æ–°å¢æ–‡ä»¶ï¼š
- app/models.py: Pydanticæ•°æ®æ¨¡å‹
- app/database.py: æ•°æ®åº“å°è£…ç±»
- app/skills.py: 7ä¸ªMockæŠ€èƒ½
- tests/test_day2.py: å•å…ƒæµ‹è¯•
- DAY2_COMPLETED.md: å®ŒæˆæŠ¥å‘Š

å¢å¼ºåŠŸèƒ½ï¼š
- å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿ
- æ‰§è¡Œæ—¶é—´å’Œæˆæœ¬ç»Ÿè®¡
- æ•°æ®åº“è¡¨ç»“æ„å‡çº§
- çœŸå®çš„ç»Ÿè®¡æŒ‡æ ‡
- ä¸°å¯Œçš„Mockåœºæ™¯

Generated with Claude Code

Co-Authored-By: Claude <noreply@anthropic.com>"

# æ¨é€
git push
```

---

## Day 1-2 é‡Œç¨‹ç¢‘

### å·²å®Œæˆ
- âœ… å®Œæ•´çš„åç«¯APIæ¡†æ¶
- âœ… å‰ç«¯èŠå¤©ç•Œé¢
- âœ… AIæ„å›¾è¯†åˆ«å’Œæ‰§è¡Œ
- âœ… æ•°æ®æ¨¡å‹å’ŒéªŒè¯
- âœ… æ•°æ®åº“å°è£…å’Œç»Ÿè®¡
- âœ… 7ä¸ªMockæŠ€èƒ½
- âœ… æ—¥å¿—å’Œç›‘æ§ç³»ç»Ÿ
- âœ… å•å…ƒæµ‹è¯•æ¡†æ¶

### å¯æ¼”ç¤º
1. ç«¯åˆ°ç«¯å¯¹è¯æµç¨‹
2. å¤šç§ä¸šåŠ¡åœºæ™¯ï¼ˆè®¢å•ã€åº“å­˜ã€é‚®ä»¶ï¼‰
3. æ•°æ®åº“å†³ç­–è®°å½•
4. å®æ—¶ç»Ÿè®¡æŒ‡æ ‡
5. é”™è¯¯å¤„ç†æœºåˆ¶

### æŠ€æœ¯æ ˆ
- FastAPI 0.109 + Uvicorn
- Claude Sonnet 4 API
- Streamlit 1.31
- SQLite + SQLAlchemy
- Pydantic 2.5
- Python 3.10+

---

**Day 2 åœ†æ»¡å®Œæˆï¼ç³»ç»Ÿå·²å…·å¤‡å®Œæ•´çš„MVPåŠŸèƒ½ï¼Œå¯ä»¥å‘è€æ¿æ¼”ç¤ºäº†ï¼** ğŸ‰
